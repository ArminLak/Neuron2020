% Morgane September 2019

% close all
% clear all

%Block 1 = large on left
%Block 2 = large on right 

IncludeVTA = 0;

[DMS_PerBlock1, DMS_PerBlock2, NAC_PerBlock1, NAC_PerBlock2, VTA_PerBlock1, VTA_PerBlock2] = get_PerformanceBlocks();
[Block1Color, Block2Color] = getColors()

StimAllowed = [-0.5 -0.25 -0.12 0 0.12 0.25 0.5];

if IncludeVTA
    PerBlock1 = [DMS_PerBlock1; NAC_PerBlock1; VTA_PerBlock1];
    PerBlock2 = [DMS_PerBlock2; NAC_PerBlock2; VTA_PerBlock2];
else
    PerBlock1 = [DMS_PerBlock1; NAC_PerBlock1];
    PerBlock2 = [DMS_PerBlock2; NAC_PerBlock2];
end




figure; 
errorbar(StimAllowed,nanmean(PerBlock1), std(PerBlock1)./sqrt(length(PerBlock1)), '-o', 'Color', Block1Color, 'LineWidth', 2, 'MarkerFaceColor', Block1Color, 'CapSize', 4 )
hold on;
errorbar(StimAllowed,nanmean(PerBlock2), std(PerBlock1)./sqrt(length(PerBlock2)), '-o', 'Color', Block2Color, 'LineWidth', 2, 'MarkerFaceColor', Block2Color, 'CapSize', 4 )
xticks(StimAllowed)
yticks([-1 0 1])
yticklabels([0 0.5 1])
ylabel('P(R)')
xlabel('Stimulus contrast')
title('Psychometric')

function [Block1Color, Block2Color] = getColors()
Block1Color = [0.5 0.2 0.1];
Block2Color = [1 0.6 0.2];
end

function [DMS_PerBlock1, DMS_PerBlock2, NAC_PerBlock1, NAC_PerBlock2, VTA_PerBlock1, VTA_PerBlock2] = get_PerformanceBlocks()
DMS_PerBlock1 = [-0.984848484848485,-0.985074626865672,-0.961165048543689,-0.266055045871560,0.162393162393162,0.400000000000000,0.875000000000000;
                -0.984848484848485,-0.985074626865672,-0.961165048543689,-0.266055045871560,0.162393162393162,0.400000000000000,0.875000000000000;
                -0.578947368421053,-0.530864197530864,-0.230769230769231,0.0294117647058824,0.684210526315790,0.772151898734177,0.840909090909091;
                -0.934426229508197,-0.559322033898305,-0.540000000000000,0.111111111111111,0.150000000000000,0.428571428571429,0.586206896551724;
                -0.934426229508197,-0.559322033898305,-0.540000000000000,0.111111111111111,0.150000000000000,0.428571428571429,0.586206896551724;
                -1,-0.966292134831461,-0.822784810126582,-0.221238938053097,0.438356164383562,0.767741935483871,0.951515151515152;
                -0.945205479452055,-0.840000000000000,-0.737226277372263,-0.0901287553648069,0.538461538461538,0.858156028368794,0.891472868217054];
            
DMS_PerBlock2 = [-0.893491124260355,-0.569620253164557,-0.165714285714286,0.556886227544910,0.891566265060241,0.928143712574850,0.988505747126437;
    -0.893491124260355,-0.569620253164557,-0.165714285714286,0.556886227544910,0.891566265060241,0.928143712574850,0.988505747126437;
    -0.600000000000000,-0.250000000000000,0.0322580645161290,0.285714285714286,0.851851851851852,0.687500000000000,1;
    -0.897435897435898,-0.493333333333333,0.0120481927710843,0.0379746835443038,0.538461538461538,0.797752808988764,0.840000000000000;
    -0.897435897435898,-0.493333333333333,0.0120481927710843,0.0379746835443038,0.538461538461538,0.797752808988764,0.840000000000000;
    -0.966386554621849,-0.887323943661972,-0.647058823529412,0.200000000000000,0.819548872180451,0.964601769911504,1;
    -0.925925925925926,-0.730769230769231,-0.236641221374046,0.664000000000000,0.984251968503937,0.981981981981982,0.982905982905983];

NAC_PerBlock1 = [-0.732283464566929,-0.539823008849558,-0.209677419354839,-0.171875000000000,0.228571428571429,0.481481481481481,0.666666666666667;
    -0.732283464566929,-0.539823008849558,-0.209677419354839,-0.171875000000000,0.228571428571429,0.481481481481481,0.666666666666667;
    -0.967032967032967,-0.930232558139535,-0.779141104294479,-0.646341463414634,0.0519480519480520,0.568181818181818,0.722891566265060;
    -0.914893617021277,-0.943502824858757,-0.738562091503268,0.129411764705882,0.279503105590062,0.337349397590361,0.505617977528090;
    -0.903614457831325,-0.762500000000000,-0.545454545454545,-0.0273972602739726,0.0465116279069767,0.378531073446328,0.520408163265306];


NAC_PerBlock2 = [-0.223300970873786,-0.0576923076923077,0.0652173913043478,0.483146067415730,0.797979797979798,0.801980198019802,0.878787878787879;
    -0.223300970873786,-0.0576923076923077,0.0652173913043478,0.483146067415730,0.797979797979798,0.801980198019802,0.878787878787879;
    -0.868852459016393,-0.763888888888889,-0.508196721311475,0.123434704830054,0.706563706563707,0.859649122807018,0.911439114391144;
    -0.668393782383420,-0.537500000000000,-0.257731958762887,0.512953367875648,0.595959595959596,0.612565445026178,0.602209944751381;
    -0.826484018264840,-0.543147208121827,-0.149758454106280,0.323671497584541,0.625615763546798,0.770833333333333,0.769230769230769];



VTA_PerBlock1 = [-0.983471074380165,-0.861751152073733,-0.632075471698113,-0.106598984771574,0.408695652173913,0.691629955947137,0.917431192660551;
-0.963636363636364,-0.935483870967742,-0.786561264822134,0.107438016528926,0.726618705035971,0.796226415094340,0.822222222222222;
-0.978494623655914,-0.780219780219780,-0.796296296296296,-0.463414634146342,0.466666666666667,0.747126436781609,0.910447761194030;
-0.897435897435898,-0.780487804878049,-0.502222222222222,-0.109311740890688,0.193548387096774,0.562753036437247,0.853658536585366];


VTA_PerBlock2 = [-0.863192182410424,-0.668874172185430,-0.0555555555555556,0.440000000000000,0.707792207792208,0.884057971014493,0.947019867549669;
-0.860139860139860,-0.608000000000000,-0.183823529411765,0.708333333333333,0.857677902621723,0.750915750915751,0.838028169014085;
-0.535135135135135,-0.392405063291139,-0.382550335570470,0.295774647887324,0.929577464788732,0.951515151515152,0.988636363636364;
-0.765182186234818,-0.407407407407407,0.0625000000000000,0.495726495726496,0.702127659574468,0.845493562231760,0.906382978723404];



end


